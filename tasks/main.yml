---
- hosts: localhost
  connection: local
  remote_user: root
#  become_method: sudo

  tasks:
#   - name: Update APT cache
#     apt:
#      update_cache: yes
#     ignore_errors: yes
#     become_user: root 

   - name: Install package python apt 
     apt:
      pkg: python-apt 
     register: curl_install


   - name: Install package curl
     apt:
      pkg: curl
     register: curl_install

   - name: Install package expect 
     apt:
      pkg: expect 
     register: expect_install


#   - name: install spinnaker 
#     script: expect_spinnaker.sh  "dev" 
#     register: spinnaker_install


   - debug: var=spinnaker_install

   - name: Hal configuration version 
     shell: hal config version edit --version 1.5.4
     register: out_1 

   - name: Hal configuration storage 
     shell: hal config storage edit --type redis
     register: out_2

   - name: add halyard account
     script: expect_hal_account.sh  "dev"
     register: spinnaker_install

#   - name: Hal configuration version
#     expect:
#      command: "hal config provider docker-registry account add my-docker-account-2 --address https://index.docker.io/ --repositories jabajaj/kubectl --username jabajaj --password"
#      responses:
#       Your docker registry password: "cisco123\n"

   - name: Hal configuration storage
     shell: sudo hal deploy apply 
#     become_method: sudo 
     register: out_2
       

